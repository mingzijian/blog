## 什么是规则引擎

规则引擎就是将需要外部决策的业务规则加载到系统中，按照不同的输入条件进行不同的规则匹配组合后，执行符合规则的一个或者多个操作。

> **背景**
>
> 生产过程中，线上的业务规则内嵌在系统的各处代码中，每次策略的调整都需要更新线上系统，进行从需求 -> 设计 -> 编码 -> 测试 -> 上线这种长周期的流程，满足不了业务规则的快速变化以及低成本的更新试错迭代。
>
> 因此需要有一种解决方案将**商业决策**和应用开发者的**技术决策**分离开，在系统运行时能去更新管理业务规则。
>
> 规则引擎业务规则管理系统，英文名为 BRMS（即 Business Rule Management System））正是这样的解决方案。

### 规则引擎核心概念

#### 事实（Fact）

事实是规则引擎中的输入数据，代表业务状态或事件。

规则引擎根据事实来评估和执行相关的业务规则。

#### 规则（rule）

 是由条件和结论构成的推理语句，一般表示为 if...Then。

一个规则的 if 部分称为 LHS，then 部分称为 RHS。

规则库是存储所有业务规则的集合，允许规则的版本控制、审计和共享。

#### 模式（module）

 模式就是指的不能再继续分割下去的最小的原子条件。



### 规则引擎核心算法

#### 前向链接（Forward Chaining）

前向链接是一种**自底向上**的推理方法，它从已知的事实（即数据）出发，逐步推导出新的结论或事实。在这种方法中，规则引擎从数据库中的事实开始，检查这些事实是否满足规则的左侧（LHS）条件，如果满足，则激活规则的右侧（RHS）动作。

前向链接的典型应用包括事件处理和实时监控系统，其中系统需要根据输入的事件或数据变化来做出响应。

#### 反向链接（Backward Chaining）

反向链接是一种**自顶向下**的推理方法，它从目标（即想要证明或实现的结论）出发，逆向寻找可以满足这个目标的规则或事实。在这种方法中，规则引擎从目标开始，逆向检查哪些规则的右侧（RHS）与目标匹配，然后尝试满足这些规则的左侧（LHS）条件。

反向链接的典型应用包括问题解决、定理证明和某些类型的查询处理，其中系统需要从目标出发，找到达到目标的路径或方法。



## 为什么需要规则引擎

### 规则引擎的价值
最大的价值就在于通过以下的三个过程，大大的缓解了频繁的需求变化给整个业务系统带来的灾难。
- 逼迫系统开发人员和业务专家梳理业务，定义统一的 BOM（业务对象模型）。
- 业务专家可以快速的制定修改规则，然后交由规则引擎自动化地来处理分析。
- 规则引擎代替系统开发人员，解决由规则条件关联动作变化带来的开发工作。







## 如何使用规则引擎
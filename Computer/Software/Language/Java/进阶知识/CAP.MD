CAP
---
#### 分布式系统的三个指标
 - Consistency （一致性）
   写操作之后的读操作，必须返回写操作之后的值。
 - Availability （可用性）
   每个客户端都能在有限的时间内得到响应，无论是读请求还是写请求。这意味着系统始终对客户端的请求做出响应，即使在部分节点失败的情况下。
 - Partition tolerance （分区容错）
   系统在遇到任何网络分区（即节点之间的通信可能丢失）的情况下仍能继续运行。

#### CAP 定理
在一个分布式系统中， Consistency（一致性）、 Availability（可用性）、Partition tolerance（分区容错性），三者不可得兼。

![CAP](https://images.gitee.com/uploads/images/2020/0617/131347_dffcb4ce_536895.png "CAP.png")

#### CAP 组合
 - C+A  如果系统需要**保证一致性和可用性**，那么在网络分区的情况下，系统可能**无法处理跨分区的请求**，从而**牺牲了分区容忍性**。
   以2阶段提交(2 phase commit)为代表的严格选举协议。当通信中断时算法不具有终止性。
 - **C+P** 如果系统需要**保证一致性和分区容忍性**，那么在网络分区发生时，系统的部分**节点可能无法提供服务**，从而**牺牲了可用性**。
   以Paxos、Raft为代表的多数派选举算法。当不可用的执行过程超过半数时，算法无法得到正确结果。
 - A+P 如果系统需**要保证可用性和分区容忍性**，那么在网络分区或节点故障的情况下，系统可能**无法保证**所有节点看到的数据是**一致**的。
   以Gossip协议为代表的冲突解决协议。当网络分区存在和执行过程正确时，只能等待分区消失才保持一致性。



CAP 理论对于理解分布式系统的设计选择至关重要。

实际上，大多数分布式系统都在这三个属性之间寻求平衡。

例如，传统的关系型数据库倾向于优先保证一致性和分区容忍性，而一些NoSQL数据库和分布式缓存系统则可能更注重可用性和分区容忍性。

